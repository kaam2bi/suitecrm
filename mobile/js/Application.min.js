function LoginUser(e){$.mobile.showPageLoadingMsg();var t=$("#SettingsPageSugarCrmUsername").val(),n=$("#SettingsPageSugarCrmPassword").val();if(e==undefined)n=$.md5(n);$.get("../service/v2/rest.php",{method:"login",input_type:"JSON",response_type:"JSON",rest_data:'[{"password":"'+n+'","user_name":"'+t+'"},"SugarCrm",{"name":"language","value":"es_es"}]'},function(t){if(t!==""){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t.name!==undefined&&t.name==="Invalid Login")e==undefined?LoginUser(true):toast("Error de acceso");else{SugarSessionId=t.id;$("#SettingsPageSugarCrmUsername").val("");$("#SettingsPageSugarCrmPassword").val("");$.mobile.changePage("#HomePage")}}else toast("Error inesperado");$.mobile.hidePageLoadingMsg()})}function LoginUserDesktop(e){$.mobile.showPageLoadingMsg();var t=$("#SettingsPageSugarCrmUsername").val(),n=$("#SettingsPageSugarCrmPassword").val();if(e==undefined)n=$.md5(n);$.get("../service/v2/rest.php",{method:"login",input_type:"JSON",response_type:"JSON",rest_data:'[{"password":"'+n+'","user_name":"'+t+'"},"SugarCrm",{"name":"language","value":"es_es"}]'},function(t){if(t!==""){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t.name!==undefined&&t.name==="Invalid Login")e==undefined?LoginUser(true):toast("Error de acceso");else{SugarSessionId=t.id;$("#SettingsPageSugarCrmUsername").val("");$("#SettingsPageSugarCrmPassword").val("");var n="../index.php";$(location).attr("href",n)}}else toast("Error inesperado");$.mobile.hidePageLoadingMsg()})}function LogOutUser(){$.get("../service/v2/rest.php",{method:"logout",input_type:"JSON",response_type:"JSON",rest_data:'[{"session":"'+SugarSessionId+'"}]'},function(){$.mobile.changePage("#LoginPage",{reverse:"true"})})}function SugarCrmGetAccountsListFromServer(e){if($("#AllAccountsListDiv li").length===0||AccountsListCurrentOffset!==e){$.mobile.pageLoading();AccountsListCurrentOffset=e;$.get("../service/v2/rest.php",{method:"get_entry_list",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Accounts","query":"","order_by":"name","offset":'+e+',"select_fields":["name","billing_address_city","billing_address_state"],"link_name_to_fields_array":"","max_results":'+RowsPerPageInListViews+',"deleted":0}'},function(t){if(t!==undefined){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t.name!==undefined&&t.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(t!==undefined&&t.entry_list!==undefined){if(t.result_count===0)AccountsListCurrentOffset=AccountsListPrevOffset+RowsPerPageInListViews;else if(t.next_offset===0)AccountsListCurrentOffset=0;if(t.next_offset===0||t.result_count===0)toast("Sin registros que mostrar");else{$("#AllAccountsListDiv li").remove();var n=0;for(n=0;n<=t.entry_list.length;n++)if(t.entry_list[n]!==undefined){var r=t.entry_list[n],i=$("<li/>"),s="<h4>"+r.name_value_list.name.value+"</h4>",o="<p>"+r.name_value_list.billing_address_city.value+"&nbsp;"+r.name_value_list.billing_address_state.value+"</p>";r=$("<a/>",{href:"#","data-identity":r.id,click:function(){CurrentAccountId=$(this).data("identity");$.mobile.changePage("#ViewAccountDetailsPage");$.mobile.pageLoading();SugarCrmGetAccountDetails()}});r.append(s);r.append(o);i.append(r);$("#AllAccountsListDiv").append(i)}$("#AllAccountsListDiv").listview("refresh");AccountsListNextOffset=t.next_offset;AccountsListPrevOffset=e-RowsPerPageInListViews}}}$.mobile.pageLoading(true)})}}function SugarCrmGetAccountDetails(){$("#ViewAccountDetailsPageDetailsList li").remove();$("#AccountNameH1").html("");$("#AccountDescriptionP").text("");$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Accounts","id":"'+CurrentAccountId+'","select_fields":"","link_name_to_fields_array":""}'},function(e){if(e!==undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!==undefined&&e.entry_list!==undefined)if(e.entry_list[0]!==undefined){e=e.entry_list[0];$("#AccountNameH1").html(e.name_value_list.name.value);$("#AccountDescriptionP").text(e.name_value_list.description.value);$("#ViewAccountDetailsPageDetailsList").append('<li data-role="list-divider">Información de la empresa</li>');var t=$("<li/>"),n=e.name_value_list.phone_office.value.replace("(","");n=n.replace(")","");n=n.replace(" ","");n=n.replace("-","");n=n.replace("+1","");var r="<h4>"+e.name_value_list.phone_office.value+"</h4>";n=$("<a/>",{href:"tel:+1"+n,rel:"external",style:"text-decoration:none;color:#444;"});n.append("<p><br />Trabajo</p>");n.append(r);t.append(n);e.name_value_list.phone_office.value!==""&&$("#ViewAccountDetailsPageDetailsList").append(t);if(e.name_value_list.website.value!==""){n="";n=e.name_value_list.website.value.substring(0,4)!=="http"?"http://"+e.name_value_list.website.value:e.name_value_list.website.value;t=$("<li/>");r="<h4>"+e.name_value_list.website.value+"</h4>";n=$("<a/>",{href:n,rel:"external",target:"_new",style:"text-decoration:none;color:#444;"});n.append("<p><br />Sitio web</p>");n.append(r);t.append(n);$("#ViewAccountDetailsPageDetailsList").append(t)}t=$("<li/>");t.append("<h4>"+e.name_value_list.phone_fax.value+"</h4>");t.append("<p>Fax</p>");e.name_value_list.phone_fax.value!==""&&$("#ViewAccountDetailsPageDetailsList").append(t);t=$("<li/>");n=e.name_value_list.billing_address_street.value;var i=e.name_value_list.billing_address_city.value,s=e.name_value_list.billing_address_state.value,o=e.name_value_list.billing_address_postalcode.value,u=e.name_value_list.billing_address_country.value,a="<h4>"+n+"<br />"+i+", "+s+" "+o+"<br />"+u+"</h4>";r=$("<a/>",{href:"http://maps.google.com/?q="+n+"%20"+i+"%20"+s+"%20"+o+"&t=m&z=13",rel:"external",target:"_new",style:"text-decoration:none;color:#444;"});r.append("<p><br />Dirección de cobro</p>");r.append(a);t.append(r);if(n!==""||i!==""||s!==""||o!==""||u!=="")$("#ViewAccountDetailsPageDetailsList").append(t);n=$("<li/>");i=e.name_value_list.shipping_address_street.value;s=e.name_value_list.shipping_address_city.value;o=e.name_value_list.shipping_address_state.value;u=e.name_value_list.shipping_address_postalcode.value;a=e.name_value_list.shipping_address_country.value;var f="<h4>"+i+"<br />"+s+", "+o+" "+u+"<br />"+a+"</h4>",l=$("<a/>",{href:"http://maps.google.com/?q="+i+"%20"+s+"%20"+o+"%20"+u+"&t=m&z=13",rel:"external",target:"_new",style:"text-decoration:none;color:#444;"});l.append("<p><br />Dirección de envio</p>");l.append(f);n.append(l);t.append(r);if(i!==""||s!==""||o!==""||u!==""||a!=="")$("#ViewAccountDetailsPageDetailsList").append(n);t=$("<li/>");r="<h4>"+e.name_value_list.email1.value+"</h4>";n=$("<a/>",{href:"mailto:"+e.name_value_list.email1.value,rel:"external",style:"text-decoration:none;color:#444;"});n.append("<p><br />Email</p>");n.append(r);t.append(n);e.name_value_list.email1.value!==""&&$("#ViewAccountDetailsPageDetailsList").append(t);$("#ViewAccountDetailsPageDetailsList").append('<li data-role="list-divider">Más información</li>');e.name_value_list.account_type!==undefined&&e.name_value_list.account_type.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Tipo de cuenta</p><h4>"+clienttypes[e.name_value_list.account_type.value]+"</h4></li>");e.name_value_list.industry!==undefined&&e.name_value_list.industry.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Industria</p><h4>"+industry[e.name_value_list.industry.value]+"</h4></li>");e.name_value_list.annual_revenue!==undefined&&e.name_value_list.annual_revenue.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Ingresos anuales:</p><h4>"+e.name_value_list.annual_revenue.value+"</h4></li>");e.name_value_list.employees!==undefined&&e.name_value_list.employees.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Empleados</p><h4>"+e.name_value_list.employees.value+"</h4></li>");e.name_value_list.sic_code!==undefined&&e.name_value_list.sic_code.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><P><br />Código CNAE/SIC:</p><h4>"+e.name_value_list.sic_code.value+"</h4></li>");e.name_value_list.ticker_symbol!==undefined&&e.name_value_list.ticker_symbol.value!=""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Símbolo Ticker</p><h4>"+e.name_value_list.ticker_symbol.value+"</h4></li>");e.name_value_list.parent_name!==undefined&&e.name_value_list.parent_name.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Miembro de</p><h4>"+e.name_value_list.parent_name.value+"</h4></li>");e.name_value_list.ownership!==undefined&&e.name_value_list.ownership.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Propietario</p><h4>"+e.name_value_list.ownership.value+"</h4></li>");e.name_value_list.campaign_name!==undefined&&e.name_value_list.campaign_name.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Campaña</p><h4>"+e.name_value_list.campaign_name.value+"</h4></li>");e.name_value_list.rating!==undefined&&e.name_value_list.rating.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Rating</p><h4>"+e.name_value_list.rating.value+"</h4></li>");$("#ViewAccountDetailsPageDetailsList").append('<li data-role="list-divider">Other</li>');e.name_value_list.assigned_user_name!==undefined&&e.name_value_list.assigned_user_name.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Asignado a</p><h4>"+e.name_value_list.assigned_user_name.value+"</h4></li>");e.name_value_list.date_modified!==undefined&&e.name_value_list.date_modified.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Fecha de modificación</p><h4>"+change(e.name_value_list.date_modified.value)+"</h4></li>");e.name_value_list.date_entered!==undefined&&e.name_value_list.date_entered.value!==""&&$("#ViewAccountDetailsPageDetailsList").append("<li><p><br />Fecha de creación</p><h4>"+change(e.name_value_list.date_entered.value)+" por "+e.name_value_list.created_by_name.value+"</h4></li>")}}$("#ViewAccountDetailsPageDetailsList").listview("refresh")});$("#ViewAccountDetailsPageContactsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Accounts","module_id":"'+CurrentAccountId+'","link_field_name":"contacts","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){$("#ViewAccountDetailsPageContactsListUl").append('<li data-role="list-divider">Contactos</li>');if(e!==undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!==undefined&&e.entry_list!==undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!==undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+"&nbsp;"+n.name_value_list.last_name.value+"</h4>",s="<p>"+n.name_value_list.title.value+"</p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentContactId=$(this).data("identity");$.mobile.changePage("#ViewContactDetailsPage");$.mobile.pageLoading();SugarCrmGetContactDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewAccountDetailsPageContactsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewAccountDetailsPageContactsListUl").append(e)}$("#ViewAccountDetailsPageContactsListUl").listview("refresh")}});$("#ViewAccountDetailsPageOpportunitiesListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Accounts","module_id":"'+CurrentAccountId+'","link_field_name":"opportunities","related_module_query":"","related_fields":["id","name","sales_stage"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){$("#ViewAccountDetailsPageOpportunitiesListUl").append('<li data-role="list-divider">Oportunidades</li>');if(e!==undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!==undefined&&e.entry_list!==undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!==undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="<p>"+status[n.name_value_list.sales_stage.value]+"</p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentOpportunityId=$(this).data("identity");$.mobile.changePage("#ViewOpportunityDetailsPage");$.mobile.pageLoading();SugarCrmGetOpportunityDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewAccountDetailsPageOpportunitiesListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewAccountDetailsPageOpportunitiesListUl").append(e)}}$("#ViewAccountDetailsPageOpportunitiesListUl").listview("refresh")});$("#ViewAccountDetailsPageLeadsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Accounts","module_id":"'+CurrentAccountId+'","link_field_name":"leads","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){$("#ViewAccountDetailsPageLeadsListUl").append('<li data-role="list-divider">Clientes potenciales</li>');if(e!==undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!==undefined&&e.entry_list!==undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!==undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+" "+n.name_value_list.last_name.value+"</h4>",s="";s=n.name_value_list.title!==undefined?"<p>"+n.name_value_list.title.value+"</p>":"<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentLeadId=$(this).data("identity");$.mobile.changePage("#ViewLeadDetailsPage");$.mobile.pageLoading();SugarCrmGetLeadDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewAccountDetailsPageLeadsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewAccountDetailsPageLeadsListUl").append(e)}}$("#ViewAccountDetailsPageLeadsListUl").listview("refresh")});$("#ViewAccountDetailsPageCallsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Accounts","module_id":"'+CurrentAccountId+'","link_field_name":"calls","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){$("#ViewAccountDetailsPageCallsListUl").append('<li data-role="list-divider">Llamadas</li>');if(e!==undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!==undefined&&e.entry_list!==undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!==undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!==undefined){s="<p>"+n.name_value_list.status.value;s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}var o=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentCallId=$(this).data("identity");$.mobile.changePage("#ViewCallDetailsPage");$.mobile.pageLoading();SugarCrmGetCallDetails()}});o.append(i);n.name_value_list.status!==undefined&&o.append(s);r.append(o);$("#ViewAccountDetailsPageCallsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewAccountDetailsPageCallsListUl").append(e)}}$("#ViewAccountDetailsPageCallsListUl").listview("refresh")});$("#ViewAccountDetailsPageMeetingsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Accounts","module_id":"'+CurrentAccountId+'","link_field_name":"meetings","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){$("#ViewAccountDetailsPageMeetingsListUl").append('<li data-role="list-divider">Reuniones</li>');if(e!==undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!==undefined&&e.entry_list!==undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!==undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!==undefined){switch(n.name_value_list.status.value){case"Held":s="<p>Realizada ";break;case"Not Held":s="<p>No realizada ";break;case"Planned":s="<p>Planeada ";break;default:s="<p>"+n.name_value_list.status.value}console.log("string"+n.name_value_list.status+"string");if(n.name_value_list.date_start!==undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentMeetingId=$(this).data("identity");$.mobile.changePage("#ViewMeetingDetailsPage");$.mobile.pageLoading();SugarCrmGetMeetingDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewAccountDetailsPageMeetingsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewAccountDetailsPageMeetingsListUl").append(e)}}$("#ViewAccountDetailsPageMeetingsListUl").listview("refresh")});$("#ViewAccountDetailsPageTasksListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Accounts","module_id":"'+CurrentAccountId+'","link_field_name":"tasks","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){$("#ViewAccountDetailsPageTasksListUl").append('<li data-role="list-divider">Tareas</li>');if(e!==undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!==undefined&&e.entry_list!==undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!==undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!==undefined){s="<p>"+n.name_value_list.status.value;if(n.name_value_list.date_start!==undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentTaskId=$(this).data("identity");$.mobile.changePage("#ViewTaskDetailsPage");$.mobile.pageLoading();SugarCrmGetTaskDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewAccountDetailsPageTasksListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewAccountDetailsPageTasksListUl").append(e)}}$("#ViewAccountDetailsPageTasksListUl").listview("refresh");$.mobile.pageLoading(true)})}function SugarCrmGetContactListFromServer(e){if($("#AllContactsListDiv li").length===0||ContactsListCurrentOffset!==e){$.mobile.pageLoading();ContactsListCurrentOffset=e;$.get("../service/v2/rest.php",{method:"get_entry_list",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Contacts","query":"","order_by":"first_name","offset":'+e+',"select_fields":["first_name","last_name","title"],"link_name_to_fields_array":"","max_results":'+RowsPerPageInListViews+',"deleted":0}'},function(t){if(t!=undefined){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t!=undefined&&t.entry_list!=undefined){if(t.result_count===0)ContactsListCurrentOffset=ContactsListPrevOffset+RowsPerPageInListViews;else if(t.next_offset===0)ContactsListCurrentOffset=0;if(t.next_offset==0||t.result_count==0)toast("Sin registros que mostrar");else{$("#AllContactsListDiv li").remove();var n=0;for(n=0;n<=t.entry_list.length;n++)if(t.entry_list[n]!=undefined){var r=t.entry_list[n],i=$("<li/>"),s="<h4>"+r.name_value_list.first_name.value+"&nbsp;"+r.name_value_list.last_name.value+"</h4>",o=r.name_value_list.title.value;o="<p>"+o+"</p>";r=$("<a/>",{href:"#","data-identity":r.id,click:function(){CurrentContactId=$(this).data("identity");$.mobile.changePage("#ViewContactDetailsPage");$.mobile.pageLoading();SugarCrmGetContactDetails()}});r.append(s);r.append(o);i.append(r);$("#AllContactsListDiv").append(i)}$("#AllContactsListDiv").listview("refresh");ContactsListNextOffset=t.next_offset;ContactsListPrevOffset=e-RowsPerPageInListViews}}}$.mobile.pageLoading(true)})}}function SugarCrmGetContactDetails(){$("#ContactNameH1").html("");$("#ContactTitleP").text("");$("#ViewContactDetailsPageDetailsList li").remove();$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Contacts","id":"'+CurrentContactId+'","select_fields":["first_name","last_name","title","phone_work","email1","description","primary_address_street","primary_address_city","primary_address_state","primary_address_postalcode","primary_address_country","phone_mobile","phone_fax","department","alt_address_street","alt_address_city","alt_address_state","alt_address_postalcode","alt_address_country"],"link_name_to_fields_array":""}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];$("#ContactNameH1").html(e.name_value_list.first_name.value+"&nbsp;"+e.name_value_list.last_name.value);var t=e.name_value_list.title.value;$("#ContactTitleP").text(t);$("#ViewContactDetailsPageDetailsList").append('<li data-role="list-divider">Contacto</li>');if(e.name_value_list.phone_work!==undefined&&e.name_value_list.phone_work.value!==""){t=$("<li/>");var n=e.name_value_list.phone_work.value.replace("(","");n=n.replace(")","");n=n.replace(" ","");n=n.replace("-","");if(e.name_value_list.phone_work!==undefined){var r="<h4>"+e.name_value_list.phone_work.value+"</h4>",i=$("<a/>",{href:"tel:+1"+n,rel:"external",style:"text-decoration:none;color:#444;"});i.append("<p><br />Trabajo</p>");i.append(r);t.append(i)}$("#ViewContactDetailsPageDetailsList").append(t)}if(e.name_value_list.email1!==undefined&&e.name_value_list.email1.value!==""){t=$("<li/>");r="<h4>"+e.name_value_list.email1.value+"</h4>";i=$("<a/>",{href:"mailto:"+e.name_value_list.email1.value,rel:"external",style:"text-decoration:none;color:#444;"});i.append("<p><br />Email</p>");i.append(r);t.append(i);$("#ViewContactDetailsPageDetailsList").append(t)}if(e.name_value_list.description!==undefined&&e.name_value_list.description.value!==""){t=$("<li/>");r="<h4>"+e.name_value_list.description.value+"</h4>";t.append("<p><br />Descripción</p>");t.append(r);$("#ViewContactDetailsPageDetailsList").append(t)}if(e.name_value_list.primary_address_street!==undefined&&e.name_value_list.primary_address_street.value!=""||e.name_value_list.primary_address_city!==undefined&&e.name_value_list.primary_address_city.value!=""||e.name_value_list.primary_address_state!==undefined&&e.name_value_list.primary_address_state.value!=""||e.name_value_list.primary_address_postalcode!==undefined&&e.name_value_list.primary_address_postalcode.value!=""||e.name_value_list.primary_address_country!==undefined&&e.name_value_list.primary_address_country.value!=""){i=e.name_value_list.primary_address_street.value;var s=e.name_value_list.primary_address_city.value,o=e.name_value_list.primary_address_state.value,u=e.name_value_list.primary_address_postalcode.value,a=e.name_value_list.primary_address_country.value;r="http://maps.google.com/?q="+i+"%20"+s+"%20"+o+"%20"+u+"&t=m&z=13";t=$("<li/>");i="<h4>"+i+"<br />"+s+", "+o+" "+u+"<br />"+a+"</h4>";r=$("<a/>",{href:r,rel:"external",target:"_new",style:"text-decoration:none;color:#444;"});r.append("<p><br />Dirección principal</p>");r.append(i);t.append(r);$("#ViewContactDetailsPageDetailsList").append(t)}if(e.name_value_list.phone_mobile!==undefined&&e.name_value_list.phone_mobile.value!==""){t=$("<li/>");r=e.name_value_list.phone_mobile.value.replace("(","");n.replace(")","");n.replace(" ","");r=n.replace("-","");n="<h4>"+e.name_value_list.phone_mobile.value+"</h4>";r=$("<a/>",{href:"tel:+1"+r,rel:"external",style:"text-decoration:none;color:#444;"});r.append("<p><br />Móvil</p>");r.append(n);t.append(r);$("#ViewContactDetailsPageDetailsList").append(t)}if(e.name_value_list.phone_fax!==undefined&&e.name_value_list.phone_fax.value!==""){n=$("<li/>");t="<h4>"+e.name_value_list.phone_fax.value+"</h4>";n.append("<p><br />Fax</p>");n.append(t);$("#ViewContactDetailsPageDetailsList").append(n)}if(e.name_value_list.department!==undefined&&e.name_value_list.department.value!==""){n=$("<li/>");t="<h4>"+e.name_value_list.department.value+"</h4>";n.append("<p><br />Department</p>");n.append(t);$("#ViewContactDetailsPageDetailsList").append(n)}if(e.name_value_list.alt_address_street!==undefined&&e.name_value_list.alt_address_street.value!=""||e.name_value_list.alt_address_city!==undefined&&e.name_value_list.alt_address_city.value!=""||e.name_value_list.alt_address_state!==undefined&&e.name_value_list.alt_address_state.value!=""||e.name_value_list.alt_address_postalcode!==undefined&&e.name_value_list.alt_address_postalcode.value!=""||e.name_value_list.alt_address_country!==undefined&&e.name_value_list.alt_address_country.value!=""){n=$("<li/>");r=e.name_value_list.alt_address_street.value;i=e.name_value_list.alt_address_city.value;s=e.name_value_list.alt_address_state.value;o=e.name_value_list.alt_address_postalcode.value;t="<h4>"+r+"<br />"+i+", "+s+" "+o+"<br />"+e.name_value_list.alt_address_country.value+"</h4>";r=$("<a/>",{href:"http://maps.google.com/?q="+r+"%20"+i+"%20"+s+"%20"+o+"&t=m&z=13",rel:"external",target:"_new",style:"text-decoration:none;color:#444;"});r.append("<p><br />Otra dirección</p>");r.append(t);n.append(r);$("#ViewContactDetailsPageDetailsList").append(n)}$("#ViewContactDetailsPageDetailsList").append('<li data-role="list-divider">Más información</li>');e.name_value_list.report_to_name!==undefined&&e.name_value_list.report_to_name.value!==""&&$("#ViewContactDetailsPageDetailsList").append("<li><p><br />Informa a</p><h4>"+e.name_value_list.report_to_name.value+"</h4></li>");e.name_value_list.lead_source!==undefined&&e.name_value_list.lead_source.value!==""&&$("#ViewContactDetailsPageDetailsList").append("<li><p><br />Proviene de</p><h4>"+e.name_value_list.lead_source.value+"</h4></li>");$("#ViewContactDetailsPageDetailsList").append('<li data-role="list-divider">Otra Información</li>');e.name_value_list.assigned_user_name!==undefined&&e.name_value_list.assigned_user_name.value!==""&&$("#ViewContactDetailsPageDetailsList").append("<li><p><br />Asignado a</p><h4>"+e.name_value_list.assigned_user_name.value+"</h4></li>");e.name_value_list.date_modified!==undefined&&e.name_value_list.date_modified.value!==""&&$("#ViewContactDetailsPageDetailsList").append("<li><p><br />Fecha de modificación</p><h4>"+e.name_value_list.date_modified.value+"&nbsp;por&nbsp;"+change(e.name_value_list.modified_by_name.value)+"</h4></li>");e.name_value_list.date_entered!==undefined&&e.name_value_list.date_entered.value!==""&&$("#ViewContactDetailsPageDetailsList").append("<li><p><br />Fecha de creación</p><h4>"+change(e.name_value_list.date_entered.value)+"&nbsp;por&nbsp;"+e.name_value_list.created_by_name.value+"</h4></li>");e.name_value_list.do_not_call!==undefined&&e.name_value_list.do_not_call.value=="true"&&toast("*NOTA: Contacto marcado como No llamar.")}$("#ViewContactDetailsPageDetailsList").listview("refresh")}});getContactRelatedOpportunitiesInsetList();getContactRelatedLeadsInsetList();getContactRelatedCallsInsetList();getContactRelatedMeetingsInsetList();getContactRelatedTasksInsetList()}function getContactRelatedOpportunitiesInsetList(){$("#ViewContactDetailsPageOpportunitiesListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Contacts","module_id":"'+CurrentContactId+'","link_field_name":"opportunities","related_module_query":"","related_fields":["id","name","sales_stage"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewContactDetailsPageOpportunitiesListUl").append('<li data-role="list-divider">Oportunidades</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="<p>"+status[n.name_value_list.sales_stage.value]+"</p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentOpportunityId=$(this).data("identity");$.mobile.changePage("#ViewOpportunityDetailsPage");$.mobile.pageLoading();SugarCrmGetOpportunityDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewContactDetailsPageOpportunitiesListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewContactDetailsPageOpportunitiesListUl").append(e)}$("#ViewContactDetailsPageOpportunitiesListUl").listview("refresh")}})}function getContactRelatedLeadsInsetList(){$("#ViewContactDetailsPageLeadsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Contacts","module_id":"'+CurrentContactId+'","link_field_name":"leads","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewContactDetailsPageLeadsListUl").append('<li data-role="list-divider">Clientes potenciales</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+" "+n.name_value_list.last_name.value+"</h4>",s="";s=n.name_value_list.title!=undefined?"<p>"+n.name_value_list.title.value+"</p>":"<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentLeadId=$(this).data("identity");$.mobile.changePage("#ViewLeadDetailsPage");$.mobile.pageLoading();SugarCrmGetLeadDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewContactDetailsPageLeadsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewContactDetailsPageLeadsListUl").append(e)}$("#ViewContactDetailsPageLeadsListUl").listview("refresh")}})}function getContactRelatedCallsInsetList(){$("#ViewContactDetailsPageCallsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Contacts","module_id":"'+CurrentContactId+'","link_field_name":"calls","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewContactDetailsPageCallsListUl").append('<li data-role="list-divider">Llamadas</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!==undefined&&e.entry_list!==undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!==undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!==undefined&&n.name_value_list.status.value!==""){s="<p>"+n.name_value_list.status.value;if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";var o=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentCallId=$(this).data("identity");$.mobile.changePage("#ViewCallDetailsPage");$.mobile.pageLoading();SugarCrmGetCallDetails()}});o.append(i);n.name_value_list.status!==undefined&&n.name_value_list.status.value!==""&&o.append(s);r.append(o);$("#ViewContactDetailsPageCallsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewContactDetailsPageCallsListUl").append(e)}$("#ViewContactDetailsPageCallsListUl").listview("refresh")}})}function getContactRelatedMeetingsInsetList(){$("#ViewContactDetailsPageMeetingsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Contacts","module_id":"'+CurrentContactId+'","link_field_name":"meetings","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewContactDetailsPageMeetingsListUl").append('<li data-role="list-divider">Reuniones</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!=undefined){switch(n.name_value_list.status.value){case"Held":s="<p>Realizada ";break;case"Not Held":s="<p>No realizada ";break;case"Planned":s="<p>Planeada ";break;default:s="<p>"+n.name_value_list.status.value}if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentMeetingId=$(this).data("identity");$.mobile.changePage("#ViewMeetingDetailsPage");$.mobile.pageLoading();SugarCrmGetMeetingDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewContactDetailsPageMeetingsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewContactDetailsPageMeetingsListUl").append(e)}$("#ViewContactDetailsPageMeetingsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getContactRelatedTasksInsetList(){$("#ViewContactDetailsPageTasksListUl li").remove();SugarSessionId==""&&$.mobile.changePage("#HomePage");$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Contacts","module_id":"'+CurrentContactId+'","link_field_name":"tasks","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewContactDetailsPageTasksListUl").append('<li data-role="list-divider">Tareas</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!=undefined){s="<p>"+n.name_value_list.status.value;if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentTaskId=$(this).data("identity");$.mobile.changePage("#ViewTaskDetailsPage");$.mobile.pageLoading();SugarCrmGetTaskDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewContactDetailsPageTasksListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewContactDetailsPageTasksListUl").append(e)}$("#ViewContactDetailsPageTasksListUl").listview("refresh")}$.mobile.pageLoading(true)})}function SugarCrmGetOpportunitiesListFromServer(e){if($("#AllOpportunitiesListDiv li").length===0||OpportunitiesListCurrentOffset!==e){$.mobile.pageLoading();OpportunitiesListCurrentOffset=e;$.get("../service/v2/rest.php",{method:"get_entry_list",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Opportunities","query":"","order_by":"amount desc","offset":'+e+',"select_fields":"","link_name_to_fields_array":"","max_results":'+RowsPerPageInListViews+',"deleted":0}'},function(t){if(t!=undefined){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t.name!==undefined&&t.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(t!=undefined&&t.entry_list!=undefined){if(t.result_count===0)OpportunitiesListCurrentOffset=OpportunitiesListPrevOffset+RowsPerPageInListViews;else if(t.next_offset===0)OpportunitiesListCurrentOffset=0;if(t.next_offset==0||t.result_count==0)toast("Sin registros que mostrar");else{$("#AllOpportunitiesListDiv li").remove();var n=0;for(n=0;n<=t.entry_list.length;n++)if(t.entry_list[n]!=undefined){var r=t.entry_list[n],i=$("<li/>"),s="<h4>"+r.name_value_list.name.value+"</h4>",o=$("<p/>");if(r.name_value_list.amount!==undefined&&r.name_value_list.amount.value!=="")if(r.name_value_list.currency_name!==undefined&&r.name_value_list.currency_name.value!==""){o.append(parseFloat(r.name_value_list.amount.value).toFixed(2));o.append(r.name_value_list.currency_symbol.value)}else{o.append(parseFloat(r.name_value_list.amount_usdollar.value).toFixed(2));o.append("$")}r.name_value_list.sales_stage!==undefined&&r.name_value_list.sales_stage.value!==""&&o.append(" - "+status[r.name_value_list.sales_stage.value]);r=$("<a/>",{href:"#","data-identity":r.id,click:function(){CurrentOpportunityId=$(this).data("identity");$.mobile.changePage("#ViewOpportunityDetailsPage");$.mobile.pageLoading();SugarCrmGetOpportunityDetails()}});r.append(s);r.append(o);i.append(r);$("#AllOpportunitiesListDiv").append(i)}$("#AllOpportunitiesListDiv").listview("refresh");OpportunitiesListNextOffset=t.next_offset;OpportunitiesListPrevOffset=e-RowsPerPageInListViews}}}$.mobile.pageLoading(true)})}}function SugarCrmGetOpportunityDetails(){$.mobile.pageLoading();$("#OpportunityNameH1").html("");$("#OpportunityDescriptionP").text("");$("#ViewOpportunityDetailsPageDetailsList li").remove();$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Opportunities","id":"'+CurrentOpportunityId+'","select_fields":"","link_name_to_fields_array":""}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];$("#OpportunityNameH1").html(e.name_value_list.name.value);$("#OpportunityDescriptionP").text(e.name_value_list.account_name.value);$("#ViewOpportunityDetailsPageDetailsList").append('<li data-role="list-divider">Oportunidad</li>');if(e.name_value_list.amount!==undefined&&e.name_value_list.amount.value!==""){var t=$("<li/>"),n=$("<p/>");n.append("<br />Monto de la oportunidad (");var r=$("<h4/>");if(e.name_value_list.currency_name!==undefined&&e.name_value_list.currency_name.value!==""){n.append(e.name_value_list.currency_name.value+")");r.append(parseFloat(e.name_value_list.amount.value).toFixed(2));r.append(e.name_value_list.currency_symbol.value)}else{n.append("USD)");r.append(parseFloat(e.name_value_list.amount_usdollar.value).toFixed(2));r.append("$")}n.append(r);t.append(n);t.append(r);$("#ViewOpportunityDetailsPageDetailsList").append(t)}e.name_value_list.date_closed!==undefined&&e.name_value_list.date_closed.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Fecha de cierre</p><h4>"+change(e.name_value_list.date_closed.value)+"</h4></li>");e.name_value_list.sales_stage!==undefined&&e.name_value_list.sales_stage.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Estado de ventas</p><h4>"+status[e.name_value_list.sales_stage.value]+"</h4></li>");e.name_value_list.opportunity_type!==undefined&&e.name_value_list.opportunity_type.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Type</p><h4>"+e.name_value_list.opportunity_type.value+"</h4></li>");e.name_value_list.probability!==undefined&&e.name_value_list.probability.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Probabilidad (%)</p><h4>"+e.name_value_list.probability.value+"</h4></li>");e.name_value_list.lead_source!==undefined&&e.name_value_list.lead_source.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Proviene de</p><h4>"+e.name_value_list.lead_source.value+"</h4></li>");e.name_value_list.next_step!==undefined&&e.name_value_list.next_step.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Siguiente paso</p><h4>"+e.name_value_list.next_step.value+"</h4></li>");e.name_value_list.description!==undefined&&e.name_value_list.description.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Descripción</p><h4>"+e.name_value_list.description.value+"</h4></li>");$("#ViewOpportunityDetailsPageDetailsList").append('<li data-role="list-divider">Oportunidad</li>');e.name_value_list.assigned_user_name!==undefined&&e.name_value_list.assigned_user_name.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Asignada a</p><h4>"+e.name_value_list.assigned_user_name.value+"</h4></li>");e.name_value_list.date_modified!==undefined&&e.name_value_list.date_modified.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Fecha de modificación</p><h4>"+change(e.name_value_list.date_modified.value)+"</h4></li>");e.name_value_list.date_entered!==undefined&&e.name_value_list.date_entered.value!==""&&$("#ViewOpportunityDetailsPageDetailsList").append("<li><p><br />Fecha de creación </p><h4>"+change(e.name_value_list.date_entered.value)+" por "+e.name_value_list.created_by_name.value+"</h4></li>")}$("#ViewOpportunityDetailsPageDetailsList").listview("refresh")}});getOpportunityRelatedContactsInsetList();getOpportunityRelatedLeadsInsetList();getOpportunityRelatedCallsInsetList();getOpportunityRelatedMeetingsInsetList();getOpportunityRelatedTasksInsetList()}function getOpportunityRelatedContactsInsetList(){$.mobile.pageLoading();$("#ViewOpportunityDetailsPageContactsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Opportunities","module_id":"'+CurrentOpportunityId+'","link_field_name":"contacts","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewOpportunityDetailsPageContactsListUl li").remove();e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined){$("#ViewOpportunityDetailsPageContactsListUl").append('<li data-role="list-divider">Contactos</li>');if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i='<h4 class="contactName">'+n.name_value_list.first_name.value+"&nbsp;"+n.name_value_list.last_name.value+"</h4>",s="<p>"+n.name_value_list.title.value+"</p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentContactId=$(this).data("identity");$.mobile.changePage("#ViewContactDetailsPage");$.mobile.pageLoading();SugarCrmGetContactDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewOpportunityDetailsPageContactsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewOpportunityDetailsPageContactsListUl").append(e)}}$("#ViewOpportunityDetailsPageContactsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getOpportunityRelatedLeadsInsetList(){$.mobile.pageLoading();$("#ViewOpportunityDetailsPageLeadsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Opportunities","module_id":"'+CurrentOpportunityId+'","link_field_name":"leads","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined){$("#ViewOpportunityDetailsPageLeadsListUl").append('<li data-role="list-divider">Clientes potenciales</li>');if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+" "+n.name_value_list.last_name.value+"</h4>",s="";s=n.name_value_list.title!=undefined?"<p>"+n.name_value_list.title.value+"</p>":"<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentLeadId=$(this).data("identity");$.mobile.changePage("#ViewLeadDetailsPage");$.mobile.pageLoading();SugarCrmGetLeadDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewOpportunityDetailsPageLeadsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewOpportunityDetailsPageLeadsListUl").append(e)}}$("#ViewOpportunityDetailsPageLeadsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getOpportunityRelatedCallsInsetList(){$.mobile.pageLoading();$("#ViewOpportunityDetailsPageCallsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Opportunities","module_id":"'+CurrentOpportunityId+'","link_field_name":"calls","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined){$("#ViewOpportunityDetailsPageCallsListUl").append('<li data-role="list-divider">Llamadas</li>');if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!=undefined){s="<p>"+n.name_value_list.status.value;if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";var o=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentCallId=$(this).data("identity");$.mobile.changePage("#ViewCallDetailsPage");$.mobile.pageLoading();SugarCrmGetCallDetails()}});o.append(i);n.name_value_list.status!=undefined&&o.append(s);r.append(o);$("#ViewOpportunityDetailsPageCallsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewOpportunityDetailsPageCallsListUl").append(e)}}$("#ViewOpportunityDetailsPageCallsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getOpportunityRelatedMeetingsInsetList(){$.mobile.pageLoading();$("#ViewOpportunityDetailsPageMeetingsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Opportunities","module_id":"'+CurrentOpportunityId+'","link_field_name":"meetings","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewOpportunityDetailsPageMeetingsListUl li").remove();e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined){$("#ViewOpportunityDetailsPageMeetingsListUl").append('<li data-role="list-divider">Reuniones</li>');if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!=undefined){switch(n.name_value_list.status.value){case"Held":s="<p>Realizada ";break;case"Not Held":s="<p>No realizada ";break;case"Planned":s="<p>Planeada ";break;default:s="<p>"+n.name_value_list.status.value}if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentMeetingId=$(this).data("identity");$.mobile.changePage("#ViewMeetingDetailsPage");$.mobile.pageLoading();SugarCrmGetMeetingDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewOpportunityDetailsPageMeetingsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewOpportunityDetailsPageMeetingsListUl").append(e)}}$("#ViewOpportunityDetailsPageMeetingsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getOpportunityRelatedTasksInsetList(){$.mobile.pageLoading();$("#ViewOpportunityDetailsPageTasksListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Opportunities","module_id":"'+CurrentOpportunityId+'","link_field_name":"tasks","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewOpportunityDetailsPageTasksListUl li").remove();e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined){$("#ViewOpportunityDetailsPageTasksListUl").append('<li data-role="list-divider">Tareas</li>');if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!=undefined){s="<p>"+n.name_value_list.status.value;if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentTaskId=$(this).data("identity");$.mobile.changePage("#ViewTaskDetailsPage");$.mobile.pageLoading();SugarCrmGetTaskDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewOpportunityDetailsPageTasksListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewOpportunityDetailsPageTasksListUl").append(e)}}$("#ViewOpportunityDetailsPageTasksListUl").listview("refresh")}$.mobile.pageLoading(true)})}function SugarCrmGetLeadsListFromServer(e){if($("#AllLeadsListDiv li").length===0||LeadsListCurrentOffset!==e){$.mobile.pageLoading();LeadsListCurrentOffset=e;$.get("../service/v2/rest.php",{method:"get_entry_list",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Leads","query":"","order_by":"name","offset":'+e+',"select_fields":"","link_name_to_fields_array":"","max_results":'+RowsPerPageInListViews+',"deleted":0}'},function(t){if(t!=undefined){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t.name!==undefined&&t.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(t!=undefined&&t.entry_list!=undefined){if(t.result_count===0)LeadsListCurrentOffset=LeadsListPrevOffset+RowsPerPageInListViews;else if(t.next_offset===0)LeadsListCurrentOffset=0;if(t.next_offset==0||t.result_count==0)toast("Sin registros que mostrar");else{$("#AllLeadsListDiv li").remove();var n=0;for(n=0;n<=t.entry_list.length;n++)if(t.entry_list[n]!=undefined){var r=t.entry_list[n],i=$("<li/>"),s="<h4>"+r.name_value_list.first_name.value+"&nbsp;"+r.name_value_list.last_name.value+"</h4>",o="<p>"+r.name_value_list.title.value+"&nbsp;"+r.name_value_list.account_name.value+"</p>";r=$("<a/>",{href:"#","data-identity":r.id,click:function(){CurrentLeadId=$(this).data("identity");$.mobile.changePage("#ViewLeadDetailsPage");$.mobile.pageLoading();SugarCrmGetLeadDetails()}});r.append(s);r.append(o);i.append(r);$("#AllLeadsListDiv").append(i)}$("#AllLeadsListDiv").listview("refresh");LeadsListNextOffset=t.next_offset;LeadsListPrevOffset=e-RowsPerPageInListViews}}}$.mobile.pageLoading(true)})}}function SugarCrmGetLeadDetails(){$("#ContactNameH1").html("");$("#ContactTitleP").text("");$("#ViewLeadDetailsPageDetailsList li").remove();$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Leads","id":"'+CurrentLeadId+'","select_fields":"","link_name_to_fields_array":""}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];$("#LeadNameH1").html(e.name_value_list.first_name.value+"&nbsp;"+e.name_value_list.last_name.value);$("#ViewLeadDetailsPageDetailsList").append('<li data-role="list-divider">Oportunidad</li>');if(e.name_value_list.phone_work!==undefined&&e.name_value_list.phone_work.value!==""){c=$("<li/>");var t=e.name_value_list.phone_work.value.replace("(","");t=t.replace(")","");t=t.replace(" ","");t=t.replace("-","");var n="<h4>"+e.name_value_list.phone_work.value+"</h4>";t=$("<a/>",{href:"tel:+1"+t,rel:"external",style:"text-decoration:none;color:#444;"});t.append("<p><br />Trabajo</p>");t.append(n);c.append(t);$("#ViewLeadDetailsPageDetailsList").append(c)}if(e.name_value_list.phone_mobile!==undefined&&e.name_value_list.phone_mobile.value!==""){c=$("<li/>");t=e.name_value_list.phone_mobile.value.replace("(","");t=t.replace(")","");t=t.replace(" ","");t=t.replace("-","");n="<h4>Móvil:&nbsp;"+e.name_value_list.phone_mobile.value+"</h4>";t=$("<a/>",{href:"tel:+1"+t,rel:"external",style:"text-decoration:none;color:#444;"});t.append("<p><br />Móvil</p>");t.append(n);c.append(t);$("#ViewLeadDetailsPageDetailsList").append(c)}if(e.name_value_list.phone_fax!==undefined&&e.name_value_list.phone_fax.value!==""){c=$("<li/>");n="<h4>"+e.name_value_list.phone_fax.value+"</h4>";c.append("<p><br />Fax</p>");c.append(n);$("#ViewLeadDetailsPageDetailsList").append(c)}e.name_value_list.department!==undefined&&e.name_value_list.department.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Departamento</p><h4>"+e.name_value_list.department.value+"</h4></li>");if(e.name_value_list.primary_address_street!==undefined&&e.name_value_list.primary_address_street.value!=""||e.name_value_list.primary_address_city!==undefined&&e.name_value_list.primary_address_city.value!=""||e.name_value_list.primary_address_state!==undefined&&e.name_value_list.primary_address_state.value!=""||e.name_value_list.primary_address_postalcode!==undefined&&e.name_value_list.primary_address_postalcode.value!=""||e.name_value_list.primary_address_country!==undefined&&e.name_value_list.primary_address_country.value!=""){c=$("<li/>");t=e.name_value_list.primary_address_street.value;var r=e.name_value_list.primary_address_city.value,i=e.name_value_list.primary_address_state.value,s=e.name_value_list.primary_address_postalcode.value;n="<h4>"+t+"<br />"+r+", "+i+s+"<br />"+e.name_value_list.primary_address_country.value+"</h4>";t=$("<a/>",{href:"http://maps.google.com/?q="+t+"%20"+r+"%20"+i+"%20"+s+"&t=m&z=13",rel:"external",target:"_new",style:"text-decoration:none;color:#444;"});t.append("<p><br />Dirección principal</p>");t.append(n);c.append(t);$("#ViewLeadDetailsPageDetailsList").append(c)}if(e.name_value_list.alt_address_street!==undefined&&e.name_value_list.alt_address_street.value!=""||e.name_value_list.alt_address_city!==undefined&&e.name_value_list.alt_address_city.value!=""||e.name_value_list.alt_address_state!==undefined&&e.name_value_list.alt_address_state.value!=""||e.name_value_list.alt_address_postalcode!==undefined&&e.name_value_list.alt_address_postalcode.value!=""||e.name_value_list.alt_address_country!==undefined&&e.name_value_list.alt_address_country.value!=""){c=$("<li/>");t=e.name_value_list.alt_address_street.value;r=e.name_value_list.alt_address_city.value;i=e.name_value_list.alt_address_state.value;s=e.name_value_list.alt_address_postalcode.value;n="<h4>"+t+"<br />"+r+", "+i+s+"<br />"+e.name_value_list.alt_address_country.value+"</h4>";t=$("<a/>",{href:"http://maps.google.com/?q="+t+"%20"+r+"%20"+i+"%20"+s+"&t=m&z=13",rel:"external",target:"_new",style:"text-decoration:none;color:#444;"});t.append("<p><br />Otra dirección</p>");t.append(n);c.append(t);$("#ViewLeadDetailsPageDetailsList").append(c)}if(e.name_value_list.email1!==undefined&&e.name_value_list.email1.value!==""){c=$("<li/>");n="<h4>"+e.name_value_list.email1.value+"</h4>";t=$("<a/>",{href:"mailto:"+e.name_value_list.email1.value,rel:"external",style:"text-decoration:none;color:#444;"});t.append("<p><br />Email</p>");t.append(n);c.append(t);$("#ViewLeadDetailsPageDetailsList").append(c)}e.name_value_list.description!==undefined&&e.name_value_list.description.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Descripción<p><h4>"+e.name_value_list.description.value+"</h4></li>");$("#ViewLeadDetailsPageDetailsList").append('<li data-role="list-divider">Más información</li>');e.name_value_list.status!==undefined&&e.name_value_list.status.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Estado<p><h4>"+status2[e.name_value_list.status.value]+"</h4></li>");e.name_value_list.lead_source!==undefined&&e.name_value_list.lead_source.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Origen<p><h4>"+sources[e.name_value_list.lead_source.value]+"</h4></li>");e.name_value_list.status_description!==undefined&&e.name_value_list.status_description.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Descripción de estado<p><h4>"+e.name_value_list.status_description.value+"</h4></li>");e.name_value_list.lead_source_description!==undefined&&e.name_value_list.lead_source_description.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Descripción de origen<p><h4>"+e.name_value_list.lead_source_description.value+"</h4></li>");e.name_value_list.opportunity_amount!==undefined&&e.name_value_list.opportunity_amount.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Monto de la oportunidad<p><h4>€"+parseFloat(e.name_value_list.opportunity_amount.value).toFixed(2)+"</h4></li>");e.name_value_list.refered_by!==undefined&&e.name_value_list.refered_by.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Referido por<p><h4>"+e.name_value_list.refered_by.value+"</h4></li>");e.name_value_list.campaign_name!==undefined&&e.name_value_list.campaign_name.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br /><p><h4>Campaña:&nbsp;"+e.name_value_list.campaign_name.value+"</h4></li>");$("#ViewLeadDetailsPageDetailsList").append('<li data-role="list-divider">Otra información</li>');e.name_value_list.assigned_user_name!==undefined&&e.name_value_list.assigned_user_name.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Asignado a</p><h4>"+e.name_value_list.assigned_user_name.value+"</h4></li>");e.name_value_list.date_modified!==undefined&&e.name_value_list.date_modified.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Fecha de modificación</p><h4>"+change(e.name_value_list.date_modified.value)+"&nbsp;por&nbsp;"+e.name_value_list.modified_by_name.value+"</h4></li>");e.name_value_list.date_entered!==undefined&&e.name_value_list.date_entered.value!==""&&$("#ViewLeadDetailsPageDetailsList").append("<li><p><br />Fecha de creación</p><h4>"+change(e.name_value_list.date_entered.value)+"&nbsp;por&nbsp;"+e.name_value_list.created_by_name.value+"</h4></li>");e.name_value_list.do_not_call.value=="true"&&toast("*NOTA: Contacto marcado como No llamar.")}$("#ViewLeadDetailsPageDetailsList").listview("refresh")}});getLeadRelatedCallsInsetList();getLeadRelatedMeetingsInsetList();getLeadRelatedTasksInsetList()}function getLeadRelatedCallsInsetList(){$("#ViewLeadDetailsPageCallsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Leads","module_id":"'+CurrentLeadId+'","link_field_name":"calls","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewLeadDetailsPageCallsListUl").append('<li data-role="list-divider">Llamadas</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!=undefined){s="<p>"+n.name_value_list.status.value;if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";var o=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentCallId=$(this).data("identity");$.mobile.changePage("#ViewCallDetailsPage")}});o.append(i);n.name_value_list.status!=undefined&&o.append(s);r.append(o);$("#ViewLeadDetailsPageCallsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewLeadDetailsPageCallsListUl").append(e)}$("#ViewLeadDetailsPageCallsListUl").listview("refresh")}})}function getLeadRelatedMeetingsInsetList(){$("#ViewLeadDetailsPageMeetingsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Leads","module_id":"'+CurrentLeadId+'","link_field_name":"meetings","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewLeadDetailsPageMeetingsListUl").append('<li data-role="list-divider">Reuniones</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!=undefined){switch(n.name_value_list.status){case"Held":s="<p>Realizada ";break;case"Not Held":s="<p>No realizada ";break;case"Planned":s="<p>Planeada ";break;default:s="<p>"+n.name_value_list.status.value}if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentMeetingId=$(this).data("identity");$.mobile.changePage("#ViewMeetingDetailsPage")}});n.append(i);n.append(s);r.append(n);$("#ViewLeadDetailsPageMeetingsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewLeadDetailsPageMeetingsListUl").append(e)}$("#ViewLeadDetailsPageMeetingsListUl").listview("refresh")}})}function getLeadRelatedTasksInsetList(){$("#ViewLeadDetailsPageTasksListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Leads","module_id":"'+CurrentLeadId+'","link_field_name":"tasks","related_module_query":"","related_fields":["id","name","status","date_start"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewLeadDetailsPageTasksListUl").append('<li data-role="list-divider">Tareas</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";if(n.name_value_list.status!=undefined){s="<p>"+n.name_value_list.status.value;if(n.name_value_list.date_start!=undefined)s+="<br/>"+change(n.name_value_list.date_start.value);s+="</p>"}else s="<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentTaskId=$(this).data("identity");$.mobile.changePage("#ViewTaskDetailsPage")}});n.append(i);n.append(s);r.append(n);$("#ViewLeadDetailsPageTasksListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewLeadDetailsPageTasksListUl").append(e)}$("#ViewLeadDetailsPageTasksListUl").listview("refresh")}$.mobile.pageLoading(true)})}function SugarCrmGetCallsListFromServer(e){if($("#AllCallsListDiv li").length===0||CallsListCurrentOffset!==e){$.mobile.pageLoading();CallsListCurrentOffset=e;$.get("../service/v2/rest.php",{method:"get_entry_list",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Calls","query":"","order_by":"date_start desc","offset":'+e+',"select_fields":"","link_name_to_fields_array":"","max_results":'+RowsPerPageInListViews+',"deleted":0}'},function(t){if(t!=undefined){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t.name!==undefined&&t.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(t!=undefined&&t.entry_list!=undefined){if(t.result_count===0)CallsListCurrentOffset=CallsListPrevOffset+RowsPerPageInListViews;else if(t.next_offset===0)CallsListCurrentOffset=0;if(t.next_offset==0||t.result_count==0)toast("Sin registros que mostrar");else{$("#AllCallsListDiv li").remove();var n=0;for(n=0;n<=t.entry_list.length;n++)if(t.entry_list[n]!=undefined){var r=t.entry_list[n],i=$("<li/>"),s="<p>"+change(r.name_value_list.date_start.value)+"</p>",o="<h4>"+r.name_value_list.name.value+"</h4>",u="<p>"+status2[r.name_value_list.direction.value]+" "+status2[r.name_value_list.status.value]+"</p>";r=$("<a/>",{href:"#","data-identity":r.id,click:function(){CurrentCallId=$(this).data("identity");$.mobile.changePage("#ViewCallDetailsPage");$.mobile.pageLoading();SugarCrmGetCallDetails()}});r.append(o);r.append(u);r.append(s);i.append(r);$("#AllCallsListDiv").append(i)}$("#AllCallsListDiv").listview("refresh");CallsListNextOffset=t.next_offset;CallsListPrevOffset=e-RowsPerPageInListViews}}}$.mobile.pageLoading(true)})}}function SugarCrmGetCallDetails(){$.mobile.pageLoading();$("#CallNameH1").html("");$("#CallSubjectP").text("");$("#ViewCallDetailsPageDetailsList li").remove();$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Calls","id":"'+CurrentCallId+'","select_fields":"","link_name_to_fields_array":""}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];$("#CallNameH1").html(e.name_value_list.name.value);var t=status2[e.name_value_list.direction.value]+" "+status2[e.name_value_list.status.value];$("#CallSubjectP").text(t);$("#ViewCallDetailsPageDetailsList").append('<li data-role="list-divider">Información de la llamada</li>');e.name_value_list.date_start!==undefined&&e.name_value_list.date_start.value!==""&&$("#ViewCallDetailsPageDetailsList").append("<li><p><br />Fecha/Hora de Inicio</p><h4>"+change(e.name_value_list.date_start.value)+"</h4></li>");e.name_value_list.duration_hours!==undefined&&e.name_value_list.duration_hours.value!==""&&$("#ViewCallDetailsPageDetailsList").append("<li><p><br />Duración</p><h4>"+e.name_value_list.duration_hours.value+"h&nbsp;"+e.name_value_list.duration_minutes.value+"m&nbsp;</h4></li>");e.name_value_list.description!==undefined&&e.name_value_list.description.value!==""&&$("#ViewCallDetailsPageDetailsList").append("<li><p><br />Descripción</p><h4>"+e.name_value_list.description.value+"</h4></li>");$("#ViewCallDetailsPageDetailsList").append('<li data-role="list-divider">Otra información</li>');e.name_value_list.assigned_user_name!==undefined&&e.name_value_list.assigned_user_name.value!==""&&$("#ViewCallDetailsPageDetailsList").append("<li><p><br />Asignado a</p><h4>"+e.name_value_list.assigned_user_name.value+"</h4></li>");e.name_value_list.date_modified!==undefined&&e.name_value_list.date_modified.value!==""&&$("#ViewCallDetailsPageDetailsList").append("<li><p><br />Fecha de modificación</p><h4>"+change(e.name_value_list.date_modified.value)+"&nbsp;por&nbsp;"+e.name_value_list.modified_by_name.value+"</h4></li>");e.name_value_list.date_entered!==undefined&&e.name_value_list.date_entered.value!==""&&$("#ViewCallDetailsPageDetailsList").append("<li><p><br />Fecha de creación</p><h4>"+change(e.name_value_list.date_entered.value)+"&nbsp;por&nbsp;"+e.name_value_list.created_by_name.value+"</h4></li>");e.name_value_list.parent_id!==undefined&&e.name_value_list.parent_id.value!==""?getCallParentDetails(e.name_value_list.parent_type.value,e.name_value_list.parent_id.value):$("#ViewCallDetailsPageDetailsList").listview("refresh")}}});getCallRelatedContactsInsetList();getCallRelatedLeadsInsetList();getCallRelatedNotesInsetList()}function getCallParentDetails(e,t){var n="<h4>"+e+":&nbsp;";$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"'+e+'","id":"'+t+'","select_fields":"","link_name_to_fields_array":""}'},function(e){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];n+=e.module_name=="Leads"||e.module_name=="Contacts"?e.name_value_list.first_name.value+" "+e.name_value_list.last_name.value:e.name_value_list.name.value}n+="</h4>";$("#ViewCallDetailsPageDetailsList").append('<li data-role="list-divider">Enlazado con</li>');$("#ViewCallDetailsPageDetailsList").append("<li>"+n+"</li>");$("#ViewCallDetailsPageDetailsList").listview("refresh")})}function getCallRelatedContactsInsetList(){$("#ViewCallDetailsPageContactsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Calls","module_id":"'+CurrentCallId+'","link_field_name":"contacts","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewCallDetailsPageContactsListUl").append('<li data-role="list-divider">Contactos</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+"&nbsp;"+n.name_value_list.last_name.value+"</h4>",s="<p>"+n.name_value_list.title.value+"</p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentContactId=$(this).data("identity");$.mobile.changePage("#ViewContactDetailsPage");$.mobile.pageLoading();SugarCrmGetContactDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewCallDetailsPageContactsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewCallDetailsPageContactsListUl").append(e)}$("#ViewCallDetailsPageContactsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getCallRelatedUsersInsetList(){$("#ViewCallDetailsPageUsersListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Calls","module_id":"'+CurrentCallId+'","link_field_name":"users","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewCallDetailsPageUsersListUl").append('<li data-role="list-divider">Usuarios</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<p>"+n.name_value_list.title.value+"</p>";r.append("<h4>"+n.name_value_list.first_name.value+"&nbsp;"+n.name_value_list.last_name.value+"</h4>");r.append(i);$("#ViewCallDetailsPageUsersListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewCallDetailsPageUsersListUl").append(e)}$("#ViewCallDetailsPageUsersListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getCallRelatedLeadsInsetList(){$("#ViewCallDetailsPageLeadsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Calls","module_id":"'+CurrentCallId+'","link_field_name":"leads","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewCallDetailsPageLeadsListUl").append('<li data-role="list-divider">Clientes potenciales</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+" "+n.name_value_list.last_name.value+"</h4>",s="";s=n.name_value_list.title!=undefined?"<p>"+n.name_value_list.title.value+"</p>":"<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentLeadId=$(this).data("identity");$.mobile.changePage("#ViewLeadDetailsPage");$.mobile.pageLoading();SugarCrmGetLeadDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewCallDetailsPageLeadsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewCallDetailsPageLeadsListUl").append(e)}$("#ViewCallDetailsPageLeadsListUl").listview("refresh")}})}function getCallRelatedNotesInsetList(){$("#ViewCallDetailsPageNotesListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Calls","module_id":"'+CurrentCallId+'","link_field_name":"notes","related_module_query":"","related_fields":["id","name","description","date_entered"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewCallDetailsPageNotesListUl").append('<li data-role="list-divider">Notas</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";s=n.name_value_list.description!=undefined?"<p>"+n.name_value_list.description.value+"</p>":"<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentNoteId=$(this).data("identity");$.mobile.changePage("#ViewNoteDetailsPage");$.mobile.pageLoading();SugarCrmGetNoteDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewCallDetailsPageNotesListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewCallDetailsPageNotesListUl").append(e)}$("#ViewCallDetailsPageNotesListUl").listview("refresh")}$.mobile.pageLoading(true)})}function SugarCrmGetMeetingsListFromServer(e){if($("#AllMeetingsListDiv li").length===0||MeetingsListCurrentOffset!==e){$.mobile.pageLoading();MeetingsListCurrentOffset=e;$.get("../service/v2/rest.php",{method:"get_entry_list",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Meetings","query":"","order_by":"date_start desc","offset":'+e+',"select_fields":"","link_name_to_fields_array":"","max_results":'+RowsPerPageInListViews+',"deleted":0}'},function(t){if(t!=undefined){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t.name!==undefined&&t.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(t!=undefined&&t.entry_list!=undefined){if(t.result_count===0)MeetingsListCurrentOffset=MeetingsListPrevOffset+RowsPerPageInListViews;else if(t.next_offset===0)MeetingsListCurrentOffset=0;if(t.next_offset==0||t.result_count==0)toast("Sin registros que mostrar");else{$("#AllMeetingsListDiv li").remove();var n=0;for(n=0;n<=t.entry_list.length;n++)if(t.entry_list[n]!=undefined){var r=t.entry_list[n],i=$("<li/>"),s="<h4>"+r.name_value_list.name.value+"</h4>";switch(r.name_value_list.status.value){case"Held":g="<p>Realizada";break;case"Not Held":g="<p>No realizada";break;case"Planned":g="<p>Planeada";break;default:g="<p>"+r.name_value_list.status.value}var o=g+" "+change(r.name_value_list.date_start.value)+"</p>";r=$("<a/>",{href:"#","data-identity":r.id,click:function(){CurrentMeetingId=$(this).data("identity");$.mobile.changePage("#ViewMeetingDetailsPage");$.mobile.pageLoading();SugarCrmGetMeetingDetails()}});r.append(s);r.append(o);i.append(r);$("#AllMeetingsListDiv").append(i)}$("#AllMeetingsListDiv").listview("refresh");MeetingsListNextOffset=t.next_offset;MeetingsListPrevOffset=e-RowsPerPageInListViews}}}$.mobile.pageLoading(true)})}}function SugarCrmGetMeetingDetails(){$.mobile.pageLoading();$("#MeetingNameH1").html("");$("#MeetingSubjectP").text("");$("#ViewMeetingDetailsPageDetailsList li").remove();$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Meetings","id":"'+CurrentMeetingId+'","select_fields":"","link_name_to_fields_array":""}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];$("#MeetingNameH1").html(e.name_value_list.name.value);var t;switch(e.name_value_list.status.value){case"Held":t="Realizada ";break;case"Not Held":t="No realizada ";break;case"Planned":t="Planeada ";break;default:t=e.name_value_list.status.value}$("#MeetingSubjectP").text(t);$("#ViewMeetingDetailsPageDetailsList").append('<li data-role="list-divider">Información de la reunión</li>');e.name_value_list.date_start!==undefined&&e.name_value_list.date_start.value!==""&&$("#ViewMeetingDetailsPageDetailsList").append("<li><p><br />Fecha/Hora de inicio</p><h4>"+change(e.name_value_list.date_start.value)+"</h4></li>");e.name_value_list.duration_hours!==undefined&&e.name_value_list.duration_hours.value!==""&&$("#ViewMeetingDetailsPageDetailsList").append("<li><p><br />Duración</p><h4>"+e.name_value_list.duration_hours.value+"h&nbsp;"+e.name_value_list.duration_minutes.value+"m&nbsp;</h4></li>");e.name_value_list.description!==undefined&&e.name_value_list.description.value!==""&&$("#ViewMeetingDetailsPageDetailsList").append("<li><p><br />Descripción</p><h4>"+e.name_value_list.description.value+"</h4></li>");$("#ViewMeetingDetailsPageDetailsList").append('<li data-role="list-divider">Otra información</li>');e.name_value_list.assigned_user_name!==undefined&&e.name_value_list.assigned_user_name.value!==""&&$("#ViewMeetingDetailsPageDetailsList").append("<li><p><br />Asignada a</p><h4>"+e.name_value_list.assigned_user_name.value+"</h4></li>");e.name_value_list.date_modified!==undefined&&e.name_value_list.date_modified.value!==""&&$("#ViewMeetingDetailsPageDetailsList").append("<li><p><br />Fecha de modificación</p><h4>"+change(e.name_value_list.date_modified.value)+"&nbsp;por&nbsp;"+e.name_value_list.modified_by_name.value+"</h4></li>");e.name_value_list.date_entered!==undefined&&e.name_value_list.date_entered.value!==""&&$("#ViewMeetingDetailsPageDetailsList").append("<li><p><br />Fecha de creación</p><h4>"+change(e.name_value_list.date_entered.value)+"&nbsp;por&nbsp;"+e.name_value_list.created_by_name.value+"</h4></li>");e.name_value_list.parent_id!==undefined&&e.name_value_list.parent_id.value!==""?getMeetingParentDetails(e.name_value_list.parent_type.value,e.name_value_list.parent_id.value):$("#ViewMeetingDetailsPageDetailsList").listview("refresh")}}});getMeetingRelatedContactsInsetList();getMeetingRelatedLeadsInsetList();getMeetingRelatedNotesInsetList()}function getMeetingParentDetails(e,t){var n="<h4>"+e+":&nbsp;";$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"'+e+'","id":"'+t+'","select_fields":"","link_name_to_fields_array":""}'},function(e){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];n+=e.module_name=="Leads"||e.module_name=="Contacts"?e.name_value_list.first_name.value+" "+e.name_value_list.last_name.value:e.name_value_list.name.value}n+="</h4>";$("#ViewMeetingDetailsPageDetailsList").append('<li data-role="list-divider">Enlazado con</li>');$("#ViewMeetingDetailsPageDetailsList").append("<li>"+n+"</li>");$("#ViewMeetingDetailsPageDetailsList").listview("refresh")})}function getMeetingRelatedContactsInsetList(){$("#ViewMeetingDetailsPageContactsListUl li").remove();SugarSessionId==""&&$.mobile.changePage("#HomePage");$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Meetings","module_id":"'+CurrentMeetingId+'","link_field_name":"contacts","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewMeetingDetailsPageContactsListUl").append('<li data-role="list-divider">Contactos</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+"&nbsp;"+n.name_value_list.last_name.value+"</h4>",s="<p>"+n.name_value_list.title.value+"</p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentContactId=$(this).data("identity");$.mobile.changePage("#ViewContactDetailsPage");$.mobile.pageLoading();SugarCrmGetContactDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewMeetingDetailsPageContactsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewMeetingDetailsPageContactsListUl").append(e)}$("#ViewMeetingDetailsPageContactsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getMeetingRelatedUsersInsetList(){$("#ViewMeetingDetailsPageUsersListUl li").remove();SugarSessionId==""&&$.mobile.changePage("#HomePage");$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Meetings","module_id":"'+CurrentMeetingId+'","link_field_name":"users","related_module_query":"","related_fields":"","related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewMeetingDetailsPageUsersListUl").append('<li data-role="list-divider">Usuarios</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<p>"+n.name_value_list.title.value+"</p>";r.append("<h4>"+n.name_value_list.first_name.value+"&nbsp;"+n.name_value_list.last_name.value+"</h4>");r.append(i);$("#ViewMeetingDetailsPageUsersListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewMeetingDetailsPageUsersListUl").append(e)}$("#ViewMeetingDetailsPageUsersListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getMeetingRelatedLeadsInsetList(){$("#ViewMeetingDetailsPageLeadsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Meetings","module_id":"'+CurrentMeetingId+'","link_field_name":"leads","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewMeetingDetailsPageLeadsListUl").append('<li data-role="list-divider">Clientes potenciales</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+" "+n.name_value_list.last_name.value+"</h4>",s="";s=n.name_value_list.title!=undefined?"<p>"+n.name_value_list.title.value+"</p>":"<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentLeadId=$(this).data("identity");$.mobile.changePage("#ViewLeadDetailsPage");$.mobile.pageLoading();SugarCrmGetLeadDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewMeetingDetailsPageLeadsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewMeetingDetailsPageLeadsListUl").append(e)}$("#ViewMeetingDetailsPageLeadsListUl").listview("refresh")}})}function getMeetingRelatedNotesInsetList(){$("#ViewMeetingDetailsPageNotesListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Meetings","module_id":"'+CurrentMeetingId+'","link_field_name":"notes","related_module_query":"","related_fields":["id","name","description","date_entered"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewMeetingDetailsPageNotesListUl").append('<li data-role="list-divider">Notas</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.name.value+"</h4>",s="";s=n.name_value_list.description!=undefined?"<p>"+n.name_value_list.description.value+"</p>":"<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentNoteId=$(this).data("identity");$.mobile.changePage("#ViewNoteDetailsPage");$.mobile.pageLoading();SugarCrmGetNoteDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewMeetingDetailsPageNotesListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewMeetingDetailsPageNotesListUl").append(e)}$("#ViewMeetingDetailsPageNotesListUl").listview("refresh")}$.mobile.pageLoading(true)})}function SugarCrmGetTasksListFromServer(e){if($("#AllTasksListDiv li").length===0||TasksListCurrentOffset!==e){$.mobile.pageLoading();TasksListCurrentOffset=e;$.get("../service/v2/rest.php",{method:"get_entry_list",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Tasks","query":"","order_by":"date_start desc","offset":'+e+',"select_fields":"","link_name_to_fields_array":"","max_results":'+RowsPerPageInListViews+',"deleted":0}'},function(t){if(t!=undefined){t=$.parseJSON(JSON.stringify(t,undefined,2));if(t.name!==undefined&&t.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(t!=undefined&&t.entry_list!=undefined){if(t.result_count===0)TasksListCurrentOffset=TasksListPrevOffset+RowsPerPageInListViews;else if(t.next_offset===0)TasksListCurrentOffset=0;if(t.next_offset==0||t.result_count==0)toast("Sin registros que mostrar");else{$("#AllTasksListDiv li").remove();var n=0;for(n=0;n<=t.entry_list.length;n++)if(t.entry_list[n]!=undefined){var r=t.entry_list[n],i=$("<li/>"),s="<h4>"+r.name_value_list.name.value+"</h4>",o="<p>"+status2[r.name_value_list.status.value]+" - "+change(r.name_value_list.date_due.value)+"</p>";r=$("<a/>",{href:"#","data-identity":r.id,click:function(){CurrentTaskId=$(this).data("identity");$.mobile.changePage("#ViewTaskDetailsPage");$.mobile.pageLoading();SugarCrmGetTaskDetails()}});r.append(s);r.append(o);i.append(r);$("#AllTasksListDiv").append(i)}$("#AllTasksListDiv").listview("refresh");TasksListNextOffset=t.next_offset;TasksListPrevOffset=e-RowsPerPageInListViews}}}$.mobile.pageLoading(true)})}}function SugarCrmGetTaskDetails(){$.mobile.pageLoading();$("#TaskNameH1").html("");$("#TaskSubjectP").text("");$("#ViewTaskDetailsPageDetailsList li").remove();$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Tasks","id":"'+CurrentTaskId+'","select_fields":"","link_name_to_fields_array":""}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];$("#TaskNameH1").html(e.name_value_list.name.value);var t=status2[e.name_value_list.status.value];$("#TaskSubjectP").text(t);$("#ViewTaskDetailsPageDetailsList").append('<li data-role="list-divider">Detalles de la tarea</li>');e.name_value_list.date_due!==undefined&&e.name_value_list.date_due.value!==""&&$("#ViewTaskDetailsPageDetailsList").append("<li><p><br />Fecha</p><h4>"+change(e.name_value_list.date_due.value)+"</h4></li>");e.name_value_list.duration_hours!==undefined&&e.name_value_list.duration_hours.value!==""&&$("#ViewTaskDetailsPageDetailsList").append("<li><p><br />Duración</p><h4>"+e.name_value_list.duration_hours.value+"h&nbsp;"+e.name_value_list.duration_minutes.value+"m&nbsp;</h4></li>");e.name_value_list.description!==undefined&&e.name_value_list.description.value!==""&&$("#ViewTaskDetailsPageDetailsList").append("<li><p><br />Descripción</p><h4>"+e.name_value_list.description.value+"</h4></li>");$("#ViewTaskDetailsPageDetailsList").append('<li data-role="list-divider">Otra información</li>');e.name_value_list.assigned_user_name!==undefined&&e.name_value_list.assigned_user_name.value!==""&&$("#ViewTaskDetailsPageDetailsList").append("<li><p><br />Asignado a</p><h4>"+e.name_value_list.assigned_user_name.value+"</h4></li>");e.name_value_list.date_modified!==undefined&&e.name_value_list.date_modified.value!==""&&$("#ViewTaskDetailsPageDetailsList").append("<li><p><br />Fecha de modificación</p><h4>"+change(e.name_value_list.date_modified.value)+"&nbsp;por&nbsp;"+e.name_value_list.modified_by_name.value+"</h4></li>");e.name_value_list.date_entered!==undefined&&e.name_value_list.date_entered.value!==""&&$("#ViewTaskDetailsPageDetailsList").append("<li><p><br />Fecha de creación</p><h4>"+change(e.name_value_list.date_entered.value)+"&nbsp;por&nbsp;"+e.name_value_list.created_by_name.value+"</h4></li>");e.name_value_list.parent_id!==undefined&&e.name_value_list.parent_id.value!==""?getTaskParentDetails(e.name_value_list.parent_type.value,e.name_value_list.parent_id.value):$("#ViewTaskDetailsPageDetailsList").listview("refresh")}}getTaskRelatedContactsInsetList();getTaskRelatedLeadsInsetList()})}function getTaskParentDetails(e,t){var n="<h4>"+e+":&nbsp;";$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"'+e+'","id":"'+t+'","select_fields":"","link_name_to_fields_array":""}'},function(e){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];n+=e.module_name=="Leads"||e.module_name=="Contacts"?e.name_value_list.first_name.value+" "+e.name_value_list.last_name.value:e.name_value_list.name.value}n+="</h4>";$("#ViewTaskDetailsPageDetailsList").append('<li data-role="list-divider">Related To</li>');$("#ViewTaskDetailsPageDetailsList").append("<li>"+n+"</li>");$("#ViewTaskDetailsPageDetailsList").listview("refresh")})}function getTaskRelatedContactsInsetList(){$("#ViewTaskDetailsPageContactsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Tasks","module_id":"'+CurrentTaskId+'","link_field_name":"contacts","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewTaskDetailsPageContactsListUl").append('<li data-role="list-divider">Contactos</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+"&nbsp;"+n.name_value_list.last_name.value+"</h4>",s="<p>"+n.name_value_list.title.value+"</p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentContactId=$(this).data("identity");$.mobile.changePage("#ViewContactDetailsPage");$.mobile.pageLoading();SugarCrmGetContactDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewTaskDetailsPageContactsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewTaskDetailsPageContactsListUl").append(e)}$("#ViewTaskDetailsPageContactsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getTaskRelatedUsersInsetList(){$("#ViewTaskDetailsPageUsersListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Tasks","module_id":"'+CurrentTaskId+'","link_field_name":"users","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewTaskDetailsPageUsersListUl").append('<li data-role="list-divider">Usuarios</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<p>"+n.name_value_list.title.value+"</p>";r.append("<h4>"+n.name_value_list.first_name.value+"&nbsp;"+n.name_value_list.last_name.value+"</h4>");r.append(i);$("#ViewTaskDetailsPageUsersListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewTaskDetailsPageUsersListUl").append(e)}$("#ViewTaskDetailsPageUsersListUl").listview("refresh")}$.mobile.pageLoading(true)})}function getTaskRelatedLeadsInsetList(){$("#ViewTaskDetailsPageLeadsListUl li").remove();$.get("../service/v2/rest.php",{method:"get_relationships",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Tasks","module_id":"'+CurrentTaskId+'","link_field_name":"leads","related_module_query":"","related_fields":["id","first_name","last_name","title"],"related_module_link_name_to_fields_array":"","deleted":0}'},function(e){if(e!=undefined){$("#ViewTaskDetailsPageLeadsListUl").append('<li data-role="list-divider">Clientes potenciales</li>');e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list.length>0){var t=0;for(t=0;t<=e.entry_list.length;t++)if(e.entry_list[t]!=undefined){var n=e.entry_list[t],r=$("<li/>"),i="<h4>"+n.name_value_list.first_name.value+" "+n.name_value_list.last_name.value+"</h4>",s="";s=n.name_value_list.title!=undefined?"<p>"+n.name_value_list.title.value+"</p>":"<p></p>";n=$("<a/>",{href:"#","data-identity":n.id,click:function(){CurrentLeadId=$(this).data("identity");$.mobile.changePage("#ViewLeadDetailsPage");$.mobile.pageLoading();SugarCrmGetLeadDetails()}});n.append(i);n.append(s);r.append(n);$("#ViewTaskDetailsPageLeadsListUl").append(r)}}else{e=$("<li/>");e.append("<h4>Sin registros que mostrar</h4>");$("#ViewTaskDetailsPageLeadsListUl").append(e)}$("#ViewTaskDetailsPageLeadsListUl").listview("refresh")}$.mobile.pageLoading(true)})}function change(e){var t=e.match(/^\s*([0-9]+)\s*-\s*([0-9]+)\s*-\s*([0-9]+)(.*)$/);if(t!==null&&t!==undefined){return t[3]+"-"+t[2]+"-"+t[1]+t[4]}else{return""}}function SugarCrmGetNoteDetails(){$("#NoteSubjectH1").html("");$("#NoteTextP").text("");$("#ViewNoteDetailsPageDetailsList li").remove();$.get("../service/v2/rest.php",{method:"get_entry",input_type:"JSON",response_type:"JSON",rest_data:'{"session":"'+SugarSessionId+'","module_name":"Notes","id":"'+CurrentNoteId+'","select_fields":"","link_name_to_fields_array":""}'},function(e){if(e!=undefined){e=$.parseJSON(JSON.stringify(e,undefined,2));if(e.name!==undefined&&e.name==="Invalid Session ID"){SugarSessionId="";$.mobile.changePage("#LoginPage")}if(e!=undefined&&e.entry_list!=undefined)if(e.entry_list[0]!=undefined){e=e.entry_list[0];$("#NoteSubjectH1").html(e.name_value_list.name.value);var t=e.name_value_list.description.value;$("#NoteTextP").text(t);$("#ViewNoteDetailsPageDetailsList").append('<li data-role="list-divider">Otra información</li>');e.name_value_list.date_modified!==undefined&&e.name_value_list.date_modified.value!==""&&$("#ViewNoteDetailsPageDetailsList").append("<li><p><br />Fecha de modificación</p><h4>"+change(e.name_value_list.date_modified.value)+"&nbsp;por&nbsp;"+e.name_value_list.modified_by_name.value+"</h4></li>");e.name_value_list.date_entered!==undefined&&e.name_value_list.date_entered.value!==""&&$("#ViewNoteDetailsPageDetailsList").append("<li><p><br />Fecha de creación</p><h4>"+change(e.name_value_list.date_entered.value)+"&nbsp;por&nbsp;"+e.name_value_list.created_by_name.value+"</h4></li>");$("#ViewNoteDetailsPageDetailsList").listview("refresh")}}$.mobile.pageLoading(true)})}var RES_LOGIN_MESSAGE="Por favor, introduzca su Usuario y Contraseña para entrar.",RES_LOGIN_TITLE="Entrar",RES_LOGOUT_LABEL="Salir",RES_HOME_LABEL="Inicio",RES_BACK_LABEL="Volver",RES_USERNAME_LABEL="Usuario",RES_PASSWORD_LABEL="Contraseña",RES_ACCOUNTS_LABEL="Empresas",RES_ACCOUNT_LABEL="Empresa",RES_CONTACTS_LABEL="Contactos",RES_CONTACT_LABEL="Contacto",RES_OPPORTUNITIES_LABEL="Oportunidades",RES_OPPORTUNITY_LABEL="Oportunidad",RES_LEADS_LABEL="Clientes potenciales",RES_LEAD_LABEL="Cliente potencial",RES_CALLS_LABEL="Llamadas",RES_CALL_LABEL="Llamada",RES_MEETINGS_LABEL="Reuniones",RES_MEETING_LABEL="Reunión",RES_TASKS_LABEL="Tareas",RES_TASK_LABEL="Tarea",RES_NOTES_LABEL="Notas",RES_NOTE_LABEL="Nota",RES_CAMPAIGN_LABEL="Campaña",RES_CAMPAIGNS_LABEL="Campañas",RES_USER_LABEL="Usuario",RES_USERS_LABEL="Usuarios",RES_OVERVIEW_LABEL="Información general",RES_MORE_INFORMATION_LABEL="Más información",RES_OTHER_LABEL="Otros",RES_ACCOUNT_BILLING_ADDRESS_LABEL="Dirección de pago",RES_ACCOUNT_SHIPPING_ADDRESS_LABEL="Dirección de envío",RES_ACCOUNT_INDUSTRY_LABEL="Industria",RES_ACCOUNT_REVENUE_LABEL="Ingresos anuales",RES_ACCOUNT_EMPLOYEES_LABEL="Empleados",RES_ACCOUNT_SIC_LABEL="Código CNAE/SIC",RES_ACCOUNT_TICKER_LABEL="Símbolo Ticket",RES_ACCOUNT_MEMBER_LABEL="Miembro de",RES_ACCOUNT_OWNERSHIP_LABEL="Propietario",RES_ACCOUNT_CAMPAIGN_LABEL="Campaña",RES_ACCOUNT_RATING_LABEL="Rating",RES_CONTACT_REPORTS_TO_LABEL="Asignado a",RES_OPPORTUNITY_NAME_LABEL="Nombre Oportunidad",RES_OPPORTUNITY_AMOUNT_WITH_CURRENCY_LABEL="Monto de la Oportunidad ({0} {1})",RES_OPPORTUNITY_AMOUNT_LABEL="Monto",RES_OPPORTUNITY_EXPECTED_CLOSE_DATE_LABEL="Fecha de cierre",RES_OPPORTUNITY_SALES_STAGE_LABEL="Etapa de ventas",RES_OPPORTUNITY_PROBABILITY_LABEL="Probabilidad",RES_OPPORTUNITY_NEXT_STEP_LABEL="Próximo paso",RES_LEAD_REFERRED_BY="Asignado a",RES_TASK_DUE_DATE_LABEL="Último cambio",RES_TASK_PRIORITY_LABEL="Prioridad",RES_OFFICE_PHONE_LABEL="Teléfono Trabajo",RES_FAX_LABEL="Fax",RES_DESCRIPTION_LABEL="Descripción",RES_EMAIL_ADDRESS_LABEL="Email",RES_LEAD_SOURCE_LABEL="Referido por",RES_RELATED_ITEM_NAME_LABEL="Nombre",RES_TYPE_LABEL="Tipo",RES_NAME_LABEL="Nombre",RES_TITLE_LABEL="Título",RES_MOBILE_PHONE_LABEL="Móvil",RES_DEPARTMENT_LABEL="Departamento",RES_PRIMARY_ADDRESS_LABEL="Dirección principal",RES_OTHER_ADDRESS_LABEL="Otra dirección",RES_WEBSITE_LABEL="Sitio Web",RES_SUBJECT="Asunto",RES_STATUS_LABEL="Estado",RES_START_DATE_TIME_LABEL="Fecha y hora de inicio",RES_START_DATE_LABEL="Fecha de inicio",RES_DURATION_LABEL="Duración",RES_LOCATION_LABEL="Lugar",RES_REMINDER_LABEL="Recordatorio",RES_DETAILS_LABEL="Detalles",RES_ASSIGNED_TO_LABEL="Asignado a",RES_DATE_MODIFIED_LABEL="Fecha de modificación",RES_DATE_CREATED_LABEL="Fecha de creación",RES_DO_NOT_CALL="*NOTA: Contacto marcado como No llamar.",RES_LOG_CALL_QUESTION="¿Desea registrar la llamada?",SugarSessionId="",RowsPerPageInListViews=20,CurrentAccountId="",CurrentContactId="",CurrentOpportunityId="",CurrentLeadId="",CurrentCallId="",CurrentMeetingId="",CurrentTaskId="",AccountsListNextOffset=0,AccountsListPrevOffset=0,AccountsListCurrentOffset=0,ContactsListNextOffset=0,ContactsListPrevOffset=0,ContactsListCurrentOffset=0,OpportunitiesListNextOffset=0,OpportunitiesListPrevOffset=0,OpportunitiesListCurrentOffset=0,LeadsListNextOffset=0,LeadsListPrevOffset=0,LeadsListCurrentOffset=0,CallsListNextOffset=0,CallsListPrevOffset=0,CallsListCurrentOffset=0,MeetingsListNextOffset=0,MeetingsListPrevOffset=0,MeetingsListCurrentOffset=0,TasksListNextOffset=0,TasksListPrevOffset=0,TasksListCurrentOffset=0,CurrentNoteId="";var status=[];status["Qualification"]="Calificación";status["Closed Lost"]="Perdida";status["Proposal/Price Quote"]="Propuesta/Presupuesto";status["Perception Analysis"]="Análisis de Percepción";status["Needs Analysis"]="Necesita Análisis";status["Prospecting"]="Prospecto";status["Value Proposition"]="Propuesta de Valor";status["Negotiation/Review"]="Negociación/Revisión";status["Id. Decision Makers"]="Id. Tomadores de Decisiones";status["Closed Won"]="Ganada";var status2=[];status2["New"]="Nuevo";status2["Dead"]="Muerto";status2["Recycled"]="Reciclado";status2["Converted"]="Convertido";status2["In Process"]="En proceso";status2["Assigned"]="Asignado";status2["Not Started"]="No Iniciada";status2["In Progress"]="En Progreso";status2["Completed"]="Completada";status2["Pending Input"]="Pendiente de Información";status2["Deferred"]="Retrasada";status2["High"]="Alta";status2["Medium"]="Media";status2["Low"]="Baja";status2["Inbound"]="Entrante";status2["Outbound"]="Saliente";status2["Planned"]="Planificada";status2["Held"]="Realizada";status2["Not Held"]="No Realizada";var sources=[];sources["Cold Call"]="Llamada en frío";sources["Existing Customer"]="Cliente existente";sources["Self Generated"]="Autogenerada";sources["Employee"]="Empleado";sources["Partner"]="Socio";sources["Public Relations"]="Relaciones públicas";sources["Direct Mail"]="Correo";sources["Conference"]="Conferencia";sources["Trade Show"]="Feria de muestras";sources["Web Site"]="Página web";sources["Word of mouth"]="Por el boca a boca";sources["Email"]="Correo electrónico";sources["Campaign"]="Campaña";sources["Other"]="Otro";var clienttypes=[];clienttypes["Analyst"]="Analista";clienttypes["Competitor"]="Competidor";clienttypes["Customer"]="Cliente";clienttypes["Integrator"]="Integrador";clienttypes["Investor"]="Inversor";clienttypes["Partner"]="Socio";clienttypes["Press"]="Prensa";clienttypes["Prospect"]="Prospecto";clienttypes["Reseller"]="Revendedor";clienttypes["Other"]="Otro";var industry=[];industry["Apparel"]="Textil";industry["Banking"]="Banca";industry["Biotechnology"]="Biotecnología";industry["Chemicals"]="Química";industry["Communications"]="Comunicaciones";industry["Construction"]="Construcción";industry["Consulting"]="Consultoría";industry["Education"]="Educación";industry["Electronics"]="Electrónica";industry["Energy"]="Energía";industry["Engineering"]="Ingeniería";industry["Entertainment"]="Entretenimiento";industry["Environmental"]="Medio ambiente";industry["Finance"]="Finanzas";industry["Government"]="Gobierno";industry["Healthcare"]="Sanidad";industry["Hospitality"]="Caridad";industry["Insurance"]="Seguros";industry["Machinery"]="Maquinaria";industry["Manufacturing"]="Fabricación";industry["Media"]="Medios de comunicación";industry["Not For Profit"]="Sin ánimo de lucro";industry["Recreation"]="Ocio";industry["Retail"]="Minoristas";industry["Shipping"]="Envíos";industry["Technology"]="Tecnología";industry["Telecommunications"]="Telecomunicaciones";industry["Transportation"]="Transporte";industry["Utilities"]="Servicios públicos";industry["Other"]="Otro";$("#HomePage").live("pagecreate",function(){$("#LogOutButton .ui-btn-text").text(RES_LOGOUT_LABEL);$("#AccountsListPageLinkLabel").text(RES_ACCOUNTS_LABEL);$("#ContactsListPageLinkLabel").text(RES_CONTACTS_LABEL);$("#OpportunitiesListPageLinkLabel").text(RES_OPPORTUNITIES_LABEL);$("#LeadsListPageLinkLabel").text(RES_LEADS_LABEL);$("#CallsListPageLinkLabel").text(RES_CALLS_LABEL);$("#MeetingsListPageLinkLabel").text(RES_MEETINGS_LABEL);$("#TasksListPageLinkLabel").text(RES_TASKS_LABEL);$("#AccountsListPageTitle").text(RES_ACCOUNTS_LABEL);$("#ContactsListPageTitle").text(RES_CONTACTS_LABEL);$("#OpportunitiesListPageTitle").text(RES_OPPORTUNITIES_LABEL);$("#LeadsListPageTitle").text(RES_LEADS_LABEL);$("#CallsListPageTitle").text(RES_CALLS_LABEL);$("#MeetingsListPageTitle").text(RES_MEETINGS_LABEL);$("#TasksListPageTitle").text(RES_TASKS_LABEL);$("#ViewContactDetailsPageTitle").text(RES_CONTACT_LABEL+" "+RES_DETAILS_LABEL);$("#ViewAccountDetailsPageTitle").text(RES_ACCOUNT_LABEL+" "+RES_DETAILS_LABEL)});$("#AccountsListPage").live("pageshow",function(){SugarCrmGetAccountsListFromServer(AccountsListCurrentOffset)});$("#ContactsListPage").live("pageshow",function(){SugarCrmGetContactListFromServer(ContactsListCurrentOffset)});$("#OpportunitiesListPage").live("pageshow",function(){SugarCrmGetOpportunitiesListFromServer(OpportunitiesListCurrentOffset)});$("#LeadsListPage").live("pageshow",function(){SugarCrmGetLeadsListFromServer(LeadsListCurrentOffset)});$("#CallsListPage").live("pageshow",function(){SugarCrmGetCallsListFromServer(CallsListCurrentOffset)});$("#MeetingsListPage").live("pageshow",function(){SugarCrmGetMeetingsListFromServer(MeetingsListCurrentOffset)});$("#TasksListPage").live("pageshow",function(){SugarCrmGetTasksListFromServer(TasksListCurrentOffset)});$("#HomePage").live("pageshow",function(){SugarSessionId===""&&$.mobile.changePage("#LoginPage")});var toast=function(e){$("<div class='ui-loader ui-overlay-shadow ui-body-e ui-corner-all'><h3>"+e+"</h3></div>").css({display:"block",opacity:.9,position:"fixed",padding:"7px","text-align":"center",width:"270px",top:"50%",left:"50%"}).appendTo($.mobile.pageContainer).delay(1500).fadeOut(400,function(){$(this).remove()})};window.onbeforeunload=function(){$.get("../service/v2/rest.php",{method:"logout",input_type:"JSON",response_type:"JSON",rest_data:'[{"session":"'+SugarSessionId+'"}]'})};(function(e){var t=function(e,t){var n,r,i,s,o;i=e&2147483648;s=t&2147483648;n=e&1073741824;r=t&1073741824;o=(e&1073741823)+(t&1073741823);if(n&r)return o^2147483648^i^s;return n|r?o&1073741824?o^3221225472^i^s:o^1073741824^i^s:o^i^s},n=function(e,n,r,i,s,o,u){e=t(e,t(t(n&r|~n&i,s),u));return t(e<<o|e>>>32-o,n)},r=function(e,n,r,i,s,o,u){e=t(e,t(t(n&i|r&~i,s),u));return t(e<<o|e>>>32-o,n)},i=function(e,n,r,i,s,o,u){e=t(e,t(t(n^r^i,s),u));return t(e<<o|e>>>32-o,n)},s=function(e,n,r,i,s,o,u){e=t(e,t(t(r^(n|~i),s),u));return t(e<<o|e>>>32-o,n)},o=function(e){var t="",n="",r;for(r=0;r<=3;r++){n=e>>>r*8&255;n="0"+n.toString(16);t+=n.substr(n.length-2,2)}return t};e.extend({md5:function(e){var u=[],a,l,h,p,v,g,y,w;u=e;u=u.replace(/\x0d\x0a/g,"\n");e="";for(a=0;a<u.length;a++){l=u.charCodeAt(a);if(l<128)e+=String.fromCharCode(l);else{if(l>127&&l<2048)e+=String.fromCharCode(l>>6|192);else{e+=String.fromCharCode(l>>12|224);e+=String.fromCharCode(l>>6&63|128)}e+=String.fromCharCode(l&63|128)}}u=e=e;e=u.length;a=e+8;l=((a-a%64)/64+1)*16;h=Array(l-1);for(v=p=0;v<e;){a=(v-v%4)/4;p=v%4*8;h[a]|=u.charCodeAt(v)<<p;v++}a=(v-v%4)/4;p=v%4*8;h[a]|=128<<p;h[l-2]=e<<3;h[l-1]=e>>>29;u=h;v=1732584193;g=4023233417;y=2562383102;w=271733878;for(e=0;e<u.length;e+=16){a=v;l=g;h=y;p=w;v=n(v,g,y,w,u[e+0],7,3614090360);w=n(w,v,g,y,u[e+1],12,3905402710);y=n(y,w,v,g,u[e+2],17,606105819);g=n(g,y,w,v,u[e+3],22,3250441966);v=n(v,g,y,w,u[e+4],7,4118548399);w=n(w,v,g,y,u[e+5],12,1200080426);y=n(y,w,v,g,u[e+6],17,2821735955);g=n(g,y,w,v,u[e+7],22,4249261313);v=n(v,g,y,w,u[e+8],7,1770035416);w=n(w,v,g,y,u[e+9],12,2336552879);y=n(y,w,v,g,u[e+10],17,4294925233);g=n(g,y,w,v,u[e+11],22,2304563134);v=n(v,g,y,w,u[e+12],7,1804603682);w=n(w,v,g,y,u[e+13],12,4254626195);y=n(y,w,v,g,u[e+14],17,2792965006);g=n(g,y,w,v,u[e+15],22,1236535329);v=r(v,g,y,w,u[e+1],5,4129170786);w=r(w,v,g,y,u[e+6],9,3225465664);y=r(y,w,v,g,u[e+11],14,643717713);g=r(g,y,w,v,u[e+0],20,3921069994);v=r(v,g,y,w,u[e+5],5,3593408605);w=r(w,v,g,y,u[e+10],9,38016083);y=r(y,w,v,g,u[e+15],14,3634488961);g=r(g,y,w,v,u[e+4],20,3889429448);v=r(v,g,y,w,u[e+9],5,568446438);w=r(w,v,g,y,u[e+14],9,3275163606);y=r(y,w,v,g,u[e+3],14,4107603335);g=r(g,y,w,v,u[e+8],20,1163531501);v=r(v,g,y,w,u[e+13],5,2850285829);w=r(w,v,g,y,u[e+2],9,4243563512);y=r(y,w,v,g,u[e+7],14,1735328473);g=r(g,y,w,v,u[e+12],20,2368359562);v=i(v,g,y,w,u[e+5],4,4294588738);w=i(w,v,g,y,u[e+8],11,2272392833);y=i(y,w,v,g,u[e+11],16,1839030562);g=i(g,y,w,v,u[e+14],23,4259657740);v=i(v,g,y,w,u[e+1],4,2763975236);w=i(w,v,g,y,u[e+4],11,1272893353);y=i(y,w,v,g,u[e+7],16,4139469664);g=i(g,y,w,v,u[e+10],23,3200236656);v=i(v,g,y,w,u[e+13],4,681279174);w=i(w,v,g,y,u[e+0],11,3936430074);y=i(y,w,v,g,u[e+3],16,3572445317);g=i(g,y,w,v,u[e+6],23,76029189);v=i(v,g,y,w,u[e+9],4,3654602809);w=i(w,v,g,y,u[e+12],11,3873151461);y=i(y,w,v,g,u[e+15],16,530742520);g=i(g,y,w,v,u[e+2],23,3299628645);v=s(v,g,y,w,u[e+0],6,4096336452);w=s(w,v,g,y,u[e+7],10,1126891415);y=s(y,w,v,g,u[e+14],15,2878612391);g=s(g,y,w,v,u[e+5],21,4237533241);v=s(v,g,y,w,u[e+12],6,1700485571);w=s(w,v,g,y,u[e+3],10,2399980690);y=s(y,w,v,g,u[e+10],15,4293915773);g=s(g,y,w,v,u[e+1],21,2240044497);v=s(v,g,y,w,u[e+8],6,1873313359);w=s(w,v,g,y,u[e+15],10,4264355552);y=s(y,w,v,g,u[e+6],15,2734768916);g=s(g,y,w,v,u[e+13],21,1309151649);v=s(v,g,y,w,u[e+4],6,4149444226);w=s(w,v,g,y,u[e+11],10,3174756917);y=s(y,w,v,g,u[e+2],15,718787259);g=s(g,y,w,v,u[e+9],21,3951481745);v=t(v,a);g=t(g,l);y=t(y,h);w=t(w,p)}return(o(v)+o(g)+o(y)+o(w)).toLowerCase()}})})(jQuery)